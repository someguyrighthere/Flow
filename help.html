<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Help Center - Flow Business Suite</title>
    <link rel="stylesheet" href="dist/css/style.min.css">
    <link rel="stylesheet" href="dist/css/Theme.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Fredoka+One&display=swap" rel="stylesheet">
    <style>
        .help-container { max-width: 900px; margin: 20px auto; }
        .faq-search { width: 100%; padding: 15px; font-size: 1.1rem; border-radius: 8px; border: 1px solid var(--card-border-color); background-color: rgba(0,0,0,0.2); color: var(--text-light); margin-bottom: 30px; box-sizing: border-box; }
        .faq-section details { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border: 1px solid var(--card-border-color); border-radius: 8px; margin-bottom: 15px; }
        .faq-section summary { font-size: 1.3rem; font-weight: 600; padding: 20px; cursor: pointer; outline: none; list-style: none; position: relative; }
        .faq-section summary::-webkit-details-marker { display: none; }
        .faq-section summary::after { content: '+'; position: absolute; right: 20px; font-size: 1.5rem; transition: transform 0.3s ease; }
        .faq-section details[open] summary::after { transform: rotate(45deg); }
        .faq-content { padding: 0 20px 20px; border-top: 1px solid var(--card-border-color); }
        .faq-item { padding: 15px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
        .faq-item:last-child { border-bottom: none; }
        .faq-item h4 { margin: 0 0 10px 0; color: var(--primary-accent); }
        .faq-item p, .faq-item ol { margin: 0; line-height: 1.6; color: var(--text-medium); }
        .card { background-color: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border: 1px solid var(--card-border-color); padding: 25px; border-radius: 16px; margin-top: 40px; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; font-weight: 600; margin-bottom: 8px; }
        .form-group select, .form-group textarea { width: 100%; padding: 12px; border-radius: 6px; border: 1px solid rgba(255, 255, 255, 0.2); background-color: rgba(0, 0, 0, 0.2); color: var(--text-light); box-sizing: border-box; font-family: 'Poppins', sans-serif; }
    </style>
</head>
<body>
    <div class="background-animation"></div>
    <div class="container">
        <header class="dashboard-header">
            <a href="suite-hub.html" style="text-decoration: none;"><h1 class="app-title">Flow Business Suite</h1></a>
            <div class="settings-menu">
                <button id="settings-button" class="btn btn-secondary">âš™</button>
                <div id="settings-dropdown" class="settings-dropdown">
                  <a href="account.html">My Account</a>
                  <a href="admin.html">Admin Settings</a>
                  <a href="pricing.html" id="upgrade-plan-link">Upgrade Plan</a>
                  <a href="help.html">Help & FAQ</a>
                  <button id="logout-button">Logout</button>
                </div>
            </div>
        </header>

        <main class="help-container">
            <h2 style="color: var(--text-light); text-align: center; margin-bottom: 30px;">Help Center & FAQ</h2>
            <input type="text" id="faq-search" class="faq-search" placeholder="Search for a topic...">
            <div class="faq-section">
                </div>

            <div class="card">
                <h3>Contact Us & Submit Feedback</h3>
                <form id="feedback-form">
                    <div class="form-group">
                        <label for="feedback-type">Type of Feedback</label>
                        <select id="feedback-type" required>
                            <option value="Suggestion">Suggestion</option>
                            <option value="Bug Report">Bug Report</option>
                            <option value="Question">Question</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="feedback-message">Your Message</label>
                        <textarea id="feedback-message" rows="5" required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Submit Feedback</button>
                    <p id="feedback-status" style="margin-top: 15px; text-align: center;"></p>
                </form>
            </div>
        </main>
    </div>

    <script type="module" src="dist/js/bundle.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // FAQ Search script remains here...

            // NEW: Script to handle feedback form submission
            const feedbackForm = document.getElementById('feedback-form');
            if(feedbackForm) {
                feedbackForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const statusEl = document.getElementById('feedback-status');
                    statusEl.textContent = 'Submitting...';

                    const payload = {
                        feedback_type: document.getElementById('feedback-type').value,
                        message: document.getElementById('feedback-message').value
                    };
                    
                    try {
                        const token = localStorage.getItem('authToken');
                        if (!token) {
                            throw new Error('You must be logged in to submit feedback.');
                        }

                        const response = await fetch('/api/feedback', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'Authorization': `Bearer ${token}`
                            },
                            body: JSON.stringify(payload)
                        });

                        const result = await response.json();
                        if (!response.ok) {
                            throw new Error(result.error || 'An unknown error occurred.');
                        }
                        
                        statusEl.textContent = result.message;
                        statusEl.style.color = 'var(--primary-accent)';
                        feedbackForm.reset();

                    } catch(error) {
                        statusEl.textContent = `Error: ${error.message}`;
                        statusEl.style.color = '#ff8a80';
                    }
                });
            }
        });
    </script>
</body>
</html>
