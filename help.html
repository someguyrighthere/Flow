<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Help Center - Flow Business Suite</title>
    <link rel="stylesheet" href="dist/css/style.min.css">
    <link rel="stylesheet" href="dist/css/Theme.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Fredoka+One&display=swap" rel="stylesheet">
    <style>
        .help-container { max-width: 900px; margin: 20px auto; }
        .faq-search { width: 100%; padding: 15px; font-size: 1.1rem; border-radius: 8px; border: 1px solid var(--card-border-color); background-color: rgba(0,0,0,0.2); color: var(--text-light); margin-bottom: 30px; box-sizing: border-box; }
        .faq-section details { background: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border: 1px solid var(--card-border-color); border-radius: 8px; margin-bottom: 15px; transition: background-color 0.3s ease; }
        .faq-section details[open] { background: rgba(255, 255, 255, 0.15); }
        .faq-section summary { font-size: 1.3rem; font-weight: 600; padding: 20px; cursor: pointer; outline: none; list-style: none; position: relative; }
        .faq-section summary::-webkit-details-marker { display: none; }
        .faq-section summary::after { content: '+'; position: absolute; right: 20px; font-size: 1.5rem; transition: transform 0.3s ease; }
        .faq-section details[open] summary::after { transform: rotate(45deg); }
        .faq-content { padding: 0 20px 20px; border-top: 1px solid var(--card-border-color); }
        .faq-item { padding: 15px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
        .faq-item:last-child { border-bottom: none; }
        .faq-item h4 { margin: 0 0 10px 0; color: var(--primary-accent); }
        .faq-item p, .faq-item ol { margin: 0; line-height: 1.6; color: var(--text-medium); }
        .card { background-color: rgba(255, 255, 255, 0.1); backdrop-filter: blur(10px); border: 1px solid var(--card-border-color); padding: 25px; border-radius: 16px; margin-top: 40px; }
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; font-weight: 600; margin-bottom: 8px; }
        .form-group select, .form-group textarea { width: 100%; padding: 12px; border-radius: 6px; border: 1px solid rgba(255, 255, 255, 0.2); background-color: rgba(0,0,0,0.2); color: var(--text-light); box-sizing: border-box; font-family: 'Poppins', sans-serif; }
    </style>
</head>
<body>
    <div class="background-animation"></div>
    <div class="container">
        <header class="dashboard-header">
            <a href="suite-hub.html" style="text-decoration: none;"><h1 class="app-title">Flow Business Suite</h1></a>
            <div class="settings-menu">
                <button id="settings-button" class="btn btn-secondary">⚙</button>
                <div id="settings-dropdown" class="settings-dropdown">
                  <a href="account.html">My Account</a>
                  <a href="admin.html">Admin Settings</a>
                  <a href="pricing.html" id="upgrade-plan-link">Upgrade Plan</a>
                  <a href="help.html">Help & FAQ</a>
                  <button id="logout-button">Logout</button>
                </div>
            </div>
        </header>

        <main class="help-container">
            <h2 style="color: var(--text-light); text-align: center; margin-bottom: 30px;">Help Center & FAQ</h2>
            <input type="text" id="faq-search" class="faq-search" placeholder="Search for a topic...">
            
            <div class="faq-section">
                <details open> <summary>Understanding Owner Dashboard Metrics</summary>
                    <div class="faq-content">
                        <div class="faq-item">
                            <h4>Account Creation Trends</h4>
                            <p>This chart tracks the growth of **new Super Admin accounts** over time, allowing you to monitor the rate at which new companies are registering as Super Admins with Flow Business Suite. You can view trends by Daily, Weekly, Monthly, or Yearly periods.</p>
                        </div>
                        <div class="faq-item">
                            <h4>Free, Pro, and Enterprise Accounts</h4>
                            <p>These counters display the total number of **Super Admin accounts** currently active on each subscription tier (Free, Pro, and Enterprise). This gives you a quick overview of your Super Admin user base distribution across plans.</p>
                        </div>
                        <div class="faq-item">
                            <h4>Estimated Monthly Revenue</h4>
                            <p>This metric calculates your estimated Monthly Recurring Revenue (MRR) based on your active Super Admin accounts on paid plans. It's calculated as:</p>
                            <p><strong>(Number of Pro Accounts x $29.99) + (Number of Enterprise Accounts x $79.00)</strong></p>
                            <p>This provides an estimate of your recurring income from Super Admin subscriptions.</p>
                        </div>
                    </div>
                </details>
                <details>
                    <summary>General & Account</summary>
                    <div class="faq-content">
                        <div class="faq-item">
                            <h4>How do I change my password?</h4>
                            <p>Navigate to "My Account" from the settings menu (⚙ icon). You will find fields to enter your current and new passwords.</p>
                        </div>
                        <div class="faq-item">
                            <h4>What do the different user roles mean?</h4>
                            <p><strong>Super Admin:</strong> Has full access to all settings, including creating locations and inviting other admins. <br><strong>Location Admin:</strong> Can manage users, schedules, and tasks for their assigned location. <br><strong>Employee:</strong> Can view their schedule, messages, and complete assigned onboarding tasks.</p>
                        </div>
                    </div>
                </details>

                <details>
                    <summary>Subscription Management</summary>
                    <div class="faq-content">
                        <div class="faq-item">
                            <h4>How do I upgrade my plan?</h4>
                            <p>You can upgrade your subscription plan at any time by visiting the <a href="pricing.html" style="color: var(--primary-accent);">Pricing page</a>. Choose your desired plan (Pro or Enterprise) and follow the prompts to complete the upgrade via Stripe's secure checkout. Your new plan will be activated immediately.</p>
                        </div>
                        <div class="faq-item">
                            <h4>How do I cancel my subscription?</h4>
                            <p>To cancel your subscription, you will need to manage it directly through your Stripe customer portal. Please refer to your original subscription confirmation email from Stripe for a link to your customer portal, or contact support for assistance. Once canceled in Stripe, your account will automatically revert to the Free tier at the end of your current billing period.</p>
                        </div>
                    </div>
                </details>
                <details>
                    <summary>Admin Settings</summary>
                    <div class="faq-content">
                        <div class="faq-item">
                            <h4>How do I invite a new employee?</h4>
                            <p>Go to "Admin Settings", find the "Invite New Employee" card, fill in their details, assign them to a location, and click "Invite Employee". They will receive an email with a temporary password.</p>
                        </div>
                        <div class="faq-item">
                            <h4>How do I create a new location?</h4>
                            <p>Only Super Admins can do this. Go to "Admin Settings" and use the "Manage Locations" card to add a new location name and address.</p>
                        </div>
                    </div>
                </details>
                
                <details>
                    <summary>Scheduling</summary>
                    <div class="faq-content">
                        <div class="faq-item">
                            <h4>How do I create a new shift?</h4>
                            <p>On the "Scheduling" page, use the "Create New Shift" form in the sidebar. Select an employee, location, start/end date and time, and click "Add Shift". The new shift will appear on the calendar instantly.</p>
                        </div>
                         <div class="faq-item">
                            <h4>How do I print the schedule?</h4>
                            <p>On the "Scheduling" page, use the "Print Schedule" button in the calendar header. This will open a printer-friendly version of the current week's schedule for the selected location.</p>
                        </div>
                    </div>
                </details>
                
                <details>
                    <summary>Onboarding & Task Lists</summary>
                    <div class="faq-content">
                        <div class="faq-item">
                            <h4>How do I create a task list for a new position?</h4>
                            <p>Navigate to the "Task Lists" page from the Onboarding Dashboard. Fill out the "Create New Task List" form, specifying which position it's for (e.g., "Sales Associate"). Add as many tasks as you need.</p>
                        </div>
                        <div class="faq-item">
                            <h4>How do I assign a task list to an employee?</h4>
                            <p>Go to the "Onboarding Dashboard" and click the "Onboard Employee" button. Select an employee from the dropdown. The system will automatically find the correct task list based on the employee's position and show you which one will be assigned.</p>
                        </div>
                    </div>
                </details>
            </div>

            <div class="card">
                <h3>Contact Us & Submit Feedback</h3>
                <form id="feedback-form">
                    <div class="form-group">
                        <label for="feedback-type">Type of Feedback</label>
                        <select id="feedback-type" required>
                            <option value="Suggestion">Suggestion</option>
                            <option value="Bug Report">Bug Report</option>
                            <option value="Question">Question</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="feedback-message">Your Message</label>
                        <textarea id="feedback-message" rows="5" required></textarea>
                    </div>
                    <button type="submit" class="btn btn-primary">Submit Feedback</button>
                    <p id="feedback-status" style="margin-top: 15px; text-align: center;"></p>
                </form>
            </div>
        </main>
    </div>

    <script type="module" src="dist/js/bundle.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const searchInput = document.getElementById('faq-search');
            if (searchInput) {
                searchInput.addEventListener('keyup', () => {
                    const filter = searchInput.value.toLowerCase();
                    const sections = document.querySelectorAll('.faq-section details');
                    sections.forEach(section => {
                        const items = section.querySelectorAll('.faq-item');
                        let hasMatch = false;
                        items.forEach(item => {
                            if (item.textContent.toLowerCase().includes(filter)) {
                                item.style.display = "";
                                hasMatch = true;
                            } else {
                                item.style.display = "none";
                            }
                        });
                        if (hasMatch || filter === '') {
                            section.style.display = "";
                        } else {
                            section.style.display = "none";
                        }
                    });
                });
            }

            const feedbackForm = document.getElementById('feedback-form');
            if(feedbackForm) {
                feedbackForm.addEventListener('submit', async (e) => {
                    e.preventDefault();
                    const statusEl = document.getElementById('feedback-status');
                    statusEl.textContent = 'Submitting...';

                    const payload = {
                        feedback_type: document.getElementById('feedback-type').value,
                        message: document.getElementById('feedback-message').value
                    };
                    
                    try {
                        const token = localStorage.getItem('authToken');
                        if (!token) {
                            throw new Error('You must be logged in to submit feedback.');
                        }

                        const response = await fetch('/api/feedback', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json',
                                'Authorization': `Bearer ${token}`
                            },
                            body: JSON.stringify(payload)
                        });

                        const result = await response.json();
                        if (!response.ok) {
                            throw new Error(result.error || 'An unknown error occurred.');
                        }
                        
                        statusEl.textContent = result.message;
                        statusEl.style.color = 'var(--primary-accent)';
                        feedbackForm.reset();

                    } catch(error) {
                        statusEl.textContent = `Error: ${error.message}`;
                        statusEl.style.color = '#ff8a80';
                    }
                });
            }
        });
    </script>
</body>
</html>
